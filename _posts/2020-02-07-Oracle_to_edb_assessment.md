---
published: true
layout: single
title: "Oracle to EDB(or PG) Assessment"
category: PostgreSQL
comments: false
---

카카오에서 연내 오라클DB를 전면 걷어내겠다고 했다는 [언론 보도](https://www.etnews.com/20200130000324?mc=em_003_00001)가 있었고 아마존에서 소비자 비즈니스 부문에서 운영했던 오라클DB의 마지막 인스턴스를 [셧다운했다는 소식](https://www.businessinsider.com/amazon-consumer-business-last-oracle-database-aws-2019-10)도 들려왔다. 오라클의 비중을 점점 낮추고 장기적으로는 탈피하여 오픈소스 계열 DB로 이관하려는 움직임이 이제 부정할 수 없는 큰 흐름이 되고 있는 것은 분명해 보이고 2020년에도 그 흐름이 이어질 것으로 보인다.  

작년에 회사 우리 팀에서도 from oracle to EDB, from SQL Server to EDB, from EDB to PostgreSQL 마이그레이션을 진행한 사례가 있었다. 이기종 간의 마이그레이션 작업은 말할 것도 없고 같은 계열 간의 마이그레이션이더라도 마이그레이션은 돌발변수가 많은 작업이어서 부담스러울 수밖에 없다.     

현재까지는 우리 팀 차원에서 대응해온 마이그레이션 의뢰들의 패턴을 보면 
1. 오픈소스 계열 DB를 도입하려는 메가트렌트에 발맞춰 가고자 하는 것 
2. 상용DB의 라이센스에 대한 비용 부담을 줄이려고 하는 측면

에서 문의해오는 경우가 많았던 것 같다.

그리고 코어 시스템에서 사용되는 오라클DB(를 비롯한 여타의 상용DB)를 마이그레이션 대상으로 하여 진행하는 것은 긴 호흡을 가지고 철저히 준비할 필요가 있을 뿐더러 고객사 측에서도 부담이 되기 때문에 비-코어 시스템에서 쓰이면서 오브젝트들이 심플하고 전체 데이터베이스의 사이즈도 작은 것들을 마이그레이션 대상으로 할 것으로 권고하고 있으며 부담이 적은 시스템의 DB 위주로 의뢰가 들어오고 있는 실정이다.  

코어 시스템에서 쓰이는 무겁고(사이즈가 크다는 측면에서 뿐만 아니라 연계된 시스템이 많고 비즈니스 로직도 복잡하다는 점에서) 핵심적인 DB를 대상으로 한 마이그레이션을 추진하는 경우라면 우리같은 업체가 전담해서 추진하는 것은 바람직하지 않고 좋은 결과를 기대하기도 힘들다고 생각한다. 그런 DB를 대상으로 추진할 때에는 원청 회사의 적극적인 협조가 필수이고 서로 협력해서 해나간다는 신뢰가 바탕에 있어야 하고 DB에서 발생하는 비즈니스 로직을 잘 이해하고 있는 부서의 참여도 필요하다고 본다. 

## 사전 미팅 단계에서 고객사와 체크해야 할 것들 (Assessment 단계)

EDB 측에서 마이그레이션 툴인 **M**igration**T**ool**K**it (이하 mtk)는 컴파일된 자바 애플리케이션으로 자바 런타임이 구축한 환경에서만 이용할 수가 있고 오라클의 경우 9i 대상으로도 사용이 가능하긴 하나 공식적으로 오라클 10g 이후 버전만 지원한다고 밝히고 있다. 이렇듯 mtk 툴만 하더라도 사용하려면 사전에 갖춰져야 할 조건들이 있다. 따라서 성공적인 마이그레이션 작업을 위해서는 사전 미팅 단계에서 as-is 시스템의 현황을 최대한 정확히 진단하는 과정과 함께 원활한 작업 진행을 위해 필요한 요건들이 무엇인지 설명하고 설득하는 과정이 필요하다.  

## 체크리스트 
효율적이면서 성공적인 마이그레이션 완료를 위해 사전에 확인해둬야 할 사항을 정리해둔다. 노하우를 쌓아나가면서 계속 업데이트 할 계획이다.   

* 기본사항으로 as-is 시스템의 DB 버전, 사용 중인 오브젝트 종류, 전체 데이터베이스 크기.  
* 특히나 이관 과정에서 까다로울 수 있는 오브젝트인 LOB, 프로시저, 파티션 테이블 사용 유무 및 사용 패턴 반드시 확인.
* db_link를 사용한다면 to-be 환경에서 db_link를 통해 target에 접근하는 통신 경로가 오픈되었는지 확인.  
* 전담 DBA를 두고 규모 있게 오라클 DBMS을 사용하는 사이트라면 AWR이나 Statspack 같은 부가기능을 꽤 heavy하게 사용하고 있을 가능성이 높다. 그에 상응하는 기능이 EDB에는 없거나 빈약하다는 점을 먼저 주지시키고 논의를 진행할 필요가 있다. 
* MTK 툴은 JDBC나 OCI 드라이버를 통해 이관 대상 오라클DB에 붙어서 메타데이터 및 데이터를 가져오는 클라이언트이기 때문에 MTK 툴이 설치된 호스트에서 대상 오라클DB로 들어가고 나오는 inbound & outbound 경로가 모두 오픈돼 있어야 한다.
* 어세스먼트 과정에서 사용하는 좋은 MTK 마이그레이션 포털의 장점을 설명하고 MTK 마이그레이션 포털 등을 이용하면 좀더 정밀한 assessment가 가능하여 마이그레이션의 성공 가능성을 높일 수 있다고 설득한다. 우리가 편하자고 하자는 것이 아니라 이런 도구를 잘 활용할수록 마이그레이션 완료라는 목적에 다가갈 수 있음을 적극 어필한다.     
